#!/usr/bin/env python3

from sys import argv
from subprocess import check_output, call

theme = argv[1]

if theme in ['--help', '-h']:
    print('usage: term_theme [options] [theme]')
    print()
    print('options:')
    print('  -h, --help   print this message ')
    print('  -l, --list   list available themes ')
    print()
elif theme in ['--list', '-l']:
    out = check_output([
        'osascript',
        '-e',
        '''set names to {}
           tell application "Terminal"
               repeat with i from 1 to count settings set
                   set end of names to settings set i's name
               end repeat
               names
           end tell'''],
           universal_newlines=True)
    names = sorted([name.strip() for name in out.split(',')])
    for name in names:
        print(name)
else:
    call([
        'osascript',
        '-e',
        '''tell application "Terminal"
               set current settings of tabs of windows to settings set "{0}"
           end tell'''.format(theme)])
