source $(asdf which direnv_use_asdf)

get_version() {
  plugin=$1
  asdf_version=$(asdf current $plugin)
  version=${asdf_version%% *}
  if [[ $version != "No" ]]; then
    echo $version
  fi
}

# Use asdf, and set env vars for the p10k prompt
use_asdf_p10k() {
  use_asdf

  py_version=$(get_version python)
  if [[ -n $py_version ]]; then
    export PYTHON_VERSION=$py_version
  fi

  node_version=$(get_version nodejs)
  if [[ -n $node_version ]]; then
    export NODE_VERSION=$node_version
  fi

  java_version=$(get_version java)
  if [[ -n $java_version ]]; then
    export JAVA_VERSION=$java_version
  fi
}

# Create and use a local python env
use_pyenv() {
  asdf_version=$(asdf current python)
  version=${asdf_version%% *}
  if [[ ! -d .asdf/python-$version ]]; then
    python -m venv .asdf/python-$version
    .asdf/python-$version/bin/pip install --upgrade pip
  fi
  export PATH=$PWD/.asdf/python-$version/bin:$PATH
}

use_local_npm() {
  export npm_config_registry=https://npm.registry.local:4873
}

# vim:filetype=bash:
