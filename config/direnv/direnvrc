source $(asdf which direnv_use_asdf)

# Use particular versions of tools (e.g. python@3.7.5)
use_tools() {
  for spec in $@; do
    plugin=${spec%@*}
    version=${spec#*@}

    asdf list $plugin &> /dev/null
    if [[ $? -ne 0 ]]; then
      echo "Plugin $plugin is not installed"
      exit 1
    fi

    eval "export ASDF_${plugin^^}_VERSION=$version"

    asdf current $plugin &> /dev/null
    if [[ $? -ne 0 ]]; then
      asdf install $plugin $version
    fi
  done

  use_asdf
}

# Create and use a local python env
use_pyenv() {
  asdf_version=$(asdf current python)
  version=${asdf_version%% *}
  if [[ ! -d .asdf/python-$version ]]; then
    python -m venv .asdf/python-$version
    .asdf/python-$version/bin/pip install --upgrade pip
  fi
  export PATH=$PWD/.asdf/python-$version/bin:$PATH
}

use_local_npm() {
  export npm_config_registry=https://npm.registry.local:4873
}

# vim:filetype=bash:
