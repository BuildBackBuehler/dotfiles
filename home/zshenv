#
# Defines environment variables before .zshrc is sourced
#

# Dotfiles
# ----------------------------------------------------------------------------
export DOTFILES=~/.dotfiles

# Editors
# ----------------------------------------------------------------------------
export EDITOR='vim'
export VISUAL='vim'

# Language
# ----------------------------------------------------------------------------
[[ -z "$LANG" ]] && eval "$(locale)"

# Cache and temp files
# ----------------------------------------------------------------------------
export CACHEDIR="$HOME/.local/share"
[[ -d "$CACHEDIR" ]] || mkdir -p "$CACHEDIR"

export ZCACHEDIR="$CACHEDIR/zsh"
[[ -d "$ZCACHEDIR" ]] || mkdir -p "$ZCACHEDIR"

if [[ -d "$TMPDIR" ]]; then
	export TMPPREFIX="${TMPDIR%/}/zsh"
	[[ -d "$TMPPREFIX" ]] || mkdir -p "$TMPPREFIX"
fi

# General paths
# ----------------------------------------------------------------------------
typeset -gU cdpath fpath mailpath manpath path
typeset -gUT INFOPATH infopath

# Set the list of directories that man searches for manuals.
while read line; do 
	manpath+=$line
done < /etc/manpaths

if [[ -e ~/Library/Python/2.7/bin ]]; then 
	path=(~/Library/Python/2.7/bin $path)
fi

path=(
	$HOME/Applications
	$path
)

# Set the list of directories that Zsh searches for function scripts.
fpath=($DOTFILES/zsh/functions /usr/local/share/zsh-completions $fpath)

# Java
# ----------------------------------------------------------------------------
if [[ -z "$JAVA_HOME" ]]; then
	JAVA_HOME=`/usr/libexec/java_home 2> /dev/null`
	if (( $? )); then
		unset JAVA_HOME
	else
		export JAVA_HOME
	fi
fi

# Go
# ----------------------------------------------------------------------------
if (( $+commands[go] )); then
	case "$OSTYPE" in
		darwin*) export GOPATH=$HOME/Documents/Programming/go ;;
		linux*)  export GOPATH=$HOME/go ;;
	esac
	path+=$GOPATH/bin
fi

# Ruby
# ----------------------------------------------------------------------------
if [[ -d $HOME/Library/Ruby/Gems/2.0.0 ]]; then
	export GEM_HOME=$HOME/Library/Ruby/Gems/2.0.0
	path+=$GEM_HOME/bin
fi

# Node
# ----------------------------------------------------------------------------
# if [[ -z "$NVM_DIR" ]]; then
# 	nvmsh="$(brew --repo nvm)/nvm.sh"
# 	if [[ -e "$nvmsh" ]]; then
# 		export NVM_DIR=~/.nvm
# 	fi
# 	unset nvmsh
# fi

# Android
# ------------------------------------------------------------------------
if (( $+commands[android] )); then
	export ANDROID_HOME=`echo $(which android)(:A:h:h)`
fi

# Local config
# --------------------------------------------------------------------------
[[ -f ~/.config/zsh/zshenv ]] && source ~/.config/zsh/zshenv

# vim:shiftwidth=4:tabstop=4:noexpandtab
